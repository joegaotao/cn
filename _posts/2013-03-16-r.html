--- 
layout: post
name: r
title: "\xE7\x81\xB0\xE8\x89\xB2\xE6\xA8\xA1\xE5\x9E\x8B\xE7\x9A\x84R\xE4\xBB\xA3\xE7\xA0\x81"
date: 2013-03-16 22:30:00 +08:00
categories: 
- "\xE7\xBC\x96\xE7\xA8\x8B"
permalink: /2013/03/r.html
---
最近帮朋友写了一个灰色模型GM(1,1)的R实现，参考网上现有的matlab代码，比较容易就可以弄出来。下面是具体过程，主函数是GM()，建立的模型是一个S3类，搭配两个自定义的泛型函数print和plot可以得到结果输出和图形。 <br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"># 本代码用来计算GM(1,1)灰度模型</span><br /><span style="color: #666666; font-style: italic;"># 输入：x 原始数据，adv为外推预测步长</span><br /><span style="color: #666666; font-style: italic;"># 输出：actual 原始数据，fit 拟合数据,degree 拟合精度，</span><br /><span style="color: #666666; font-style: italic;">#       C 后验差比值，P 小概率误差，predict 外推预测值</span><br />&nbsp;<br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 主函数</span><br />GM &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>adv=<span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />    x0 &lt;- x<br />    k = <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>x0<span style="color: #009900;">)</span><br />    <span style="color: #666666; font-style: italic;"># AGO</span><br />    x1 = <a href="http://inside-r.org/r-doc/base/cumsum"><span style="color: #003399; font-weight: bold;">cumsum</span></a><span style="color: #009900;">(</span>x0<span style="color: #009900;">)</span><br />    <span style="color: #666666; font-style: italic;"># construct matrix B &amp; Y</span><br />    B = <a href="http://inside-r.org/r-doc/base/cbind"><span style="color: #003399; font-weight: bold;">cbind</span></a><span style="color: #009900;">(</span>-<span style="color: #cc66cc;">0.5</span>*<span style="color: #009900;">(</span>x1<span style="color: #009900;">[</span>-k<span style="color: #009900;">]</span>+x1<span style="color: #009900;">[</span>-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>times=k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    Y = x0<span style="color: #009900;">[</span>-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br />    <span style="color: #666666; font-style: italic;"># compute BtB...</span><br />    BtB = <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">(</span>B<span style="color: #009900;">)</span>%*%B<br />    BtB.inv = <a href="http://inside-r.org/r-doc/base/solve"><span style="color: #003399; font-weight: bold;">solve</span></a><span style="color: #009900;">(</span>BtB<span style="color: #009900;">)</span><br />    BtY = <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">(</span>B<span style="color: #009900;">)</span>%*%Y<br />&nbsp;<br />    <span style="color: #666666; font-style: italic;"># estimate</span><br />    alpha = BtB.inv%*%BtY<br />&nbsp;<br />    <span style="color: #666666; font-style: italic;"># 建立预测模型</span><br />&nbsp;<br />    <a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a> &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>k<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />        y = <span style="color: #009900;">(</span>x0<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span> - alpha<span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span>/alpha<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>*<a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">(</span>-alpha<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span>*k<span style="color: #009900;">)</span>+alpha<span style="color: #009900;">[</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">]</span>/alpha<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><br />        <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span>y<span style="color: #009900;">)</span><br />    <span style="color: #009900;">}</span><br />    pre &lt;- <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">(</span>X=<span style="color: #cc66cc;">0</span>:<span style="color: #009900;">(</span>k-<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span>FUN=<a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">)</span><br />    prediff &lt;- <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span>pre<span style="color: #009900;">[</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/diff"><span style="color: #003399; font-weight: bold;">diff</span></a><span style="color: #009900;">(</span>pre<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    <span style="color: #666666; font-style: italic;"># 计算残差</span><br />    error &lt;- <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/abs"><span style="color: #003399; font-weight: bold;">abs</span></a><span style="color: #009900;">(</span>prediff-x0<span style="color: #009900;">)</span><span style="color: #339933;">,</span>digits=<span style="color: #cc66cc;">6</span><span style="color: #009900;">)</span><br />    emax &lt;- <a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">(</span>error<span style="color: #009900;">)</span><br />    emin &lt;- <a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">(</span>error<span style="color: #009900;">)</span><br />    <span style="color: #666666; font-style: italic;"># 模型评价</span><br />    incidence &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />         <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span><span style="color: #009900;">(</span>emin + <span style="color: #cc66cc;">0.5</span>*emax<span style="color: #009900;">)</span>/<span style="color: #009900;">(</span>x+<span style="color: #cc66cc;">0.5</span>*emax<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    <span style="color: #009900;">}</span><br />    degree &lt;- <a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">(</span>error<span style="color: #339933;">,</span>incidence<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />&nbsp;<br />    s1 &lt;- <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">(</span><span style="color: #009900;">(</span>x0-<a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">(</span>x0<span style="color: #009900;">)</span><span style="color: #009900;">)</span>^<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span>/<span style="color: #cc66cc;">5</span><span style="color: #009900;">)</span><br />    s2 &lt;- <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">(</span><span style="color: #009900;">(</span>error-<a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">(</span>error<span style="color: #009900;">)</span><span style="color: #009900;">)</span>^<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span>/<span style="color: #cc66cc;">5</span><span style="color: #009900;">)</span><br />&nbsp;<br />    <a href="http://inside-r.org/r-doc/stats/C"><span style="color: #003399; font-weight: bold;">C</span></a> &lt;- s2/s1<br />&nbsp;<br />    e &lt;- <a href="http://inside-r.org/r-doc/base/abs"><span style="color: #003399; font-weight: bold;">abs</span></a><span style="color: #009900;">(</span>error-<a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">(</span>error<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    p &lt;- <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>e&lt;<span style="color: #cc66cc;">0.6745</span><span style="color: #009900;">)</span>/length<span style="color: #009900;">(</span>e<span style="color: #009900;">)</span><br />&nbsp;<br />    result &lt;- <a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">(</span>actual = x0<span style="color: #339933;">,</span><br />                   fit = prediff<span style="color: #339933;">,</span><br />                   degree = degree<span style="color: #339933;">,</span><br />                   <a href="http://inside-r.org/r-doc/stats/C"><span style="color: #003399; font-weight: bold;">C</span></a> = <a href="http://inside-r.org/r-doc/stats/C"><span style="color: #003399; font-weight: bold;">C</span></a><span style="color: #339933;">,</span><br />                   P = p<span style="color: #009900;">)</span><br />&nbsp;<br />    <span style="color: #666666; font-style: italic;"># 外推预测第k+adv项</span><br />    <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>adv &gt; <span style="color: #cc66cc;">0</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />        pre.adv &lt;- <a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">(</span>k+adv-<span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span>-<a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">(</span>k+adv-<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><br />&nbsp;<br />        result$predict &lt;- pre.adv<br />     <span style="color: #009900;">}</span><br />    <a href="http://inside-r.org/r-doc/base/class"><span style="color: #003399; font-weight: bold;">class</span></a><span style="color: #009900;">(</span>result<span style="color: #009900;">)</span> &lt;- <span style="color: blue;">'GM1.1'</span><br />    <a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">(</span>result<span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 增加对应gm1.1类的泛型函数 print &amp; plot</span><br />print.GM1.1 &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>mod<span style="color: #009900;">)</span><span style="color: #009900;">{</span><br />    <a href="http://inside-r.org/r-doc/base/cat"><span style="color: #003399; font-weight: bold;">cat</span></a><span style="color: #009900;">(</span><span style="color: blue;">'the result of GM(1,1)<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #009900;">)</span><br />    <a href="http://inside-r.org/r-doc/base/cat"><span style="color: #003399; font-weight: bold;">cat</span></a><span style="color: #009900;">(</span><span style="color: blue;">'Actual Data:'</span><span style="color: #339933;">,</span> <span style="color: blue;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #339933;">,</span>mod$actual <span style="color: #339933;">,</span><span style="color: blue;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #009900;">)</span><br />    <a href="http://inside-r.org/r-doc/base/cat"><span style="color: #003399; font-weight: bold;">cat</span></a><span style="color: #009900;">(</span><span style="color: blue;">'Fit Data:'</span><span style="color: #339933;">,</span> <span style="color: blue;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span>mod$fit<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span> <span style="color: #339933;">,</span><span style="color: blue;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #009900;">)</span><br />    <a href="http://inside-r.org/r-doc/base/cat"><span style="color: #003399; font-weight: bold;">cat</span></a><span style="color: #009900;">(</span><span style="color: blue;">'Degree:'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span>mod$degree<span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span> <span style="color: #339933;">,</span><span style="color: blue;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #009900;">)</span><br />    <a href="http://inside-r.org/r-doc/base/cat"><span style="color: #003399; font-weight: bold;">cat</span></a><span style="color: #009900;">(</span><span style="color: blue;">'C:'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span>mod$C<span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span> <span style="color: #339933;">,</span><span style="color: blue;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #009900;">)</span><br />    <a href="http://inside-r.org/r-doc/base/cat"><span style="color: #003399; font-weight: bold;">cat</span></a><span style="color: #009900;">(</span><span style="color: blue;">'P:'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span>mod$P<span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span> <span style="color: #339933;">,</span><span style="color: blue;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #009900;">)</span><br />    <span style="color: black; font-weight: bold;">if</span> <span style="color: #009900;">(</span>!<a href="http://inside-r.org/r-doc/base/is.null"><span style="color: #003399; font-weight: bold;">is.null</span></a><span style="color: #009900;">(</span>mod$predict<span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span><br />        <a href="http://inside-r.org/r-doc/base/cat"><span style="color: #003399; font-weight: bold;">cat</span></a><span style="color: #009900;">(</span><span style="color: blue;">'Predict Data:'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">(</span>mod$predict<span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <span style="color: blue;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #009900;">)</span><br />    <span style="color: #009900;">}</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />plot.GM1.1 &lt;- <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">(</span>mod<span style="color: #339933;">,</span>adv=<span style="color: #cc66cc;">5</span><span style="color: #009900;">)</span><span style="color: #009900;">{</span><br />    prex &lt;- <a href="http://inside-r.org/r-doc/base/numeric"><span style="color: #003399; font-weight: bold;">numeric</span></a><span style="color: #009900;">(</span>adv<span style="color: #009900;">)</span><br />    x &lt;- mod$actual<br />    <span style="color: black; font-weight: bold;">for</span> <span style="color: #009900;">(</span>k <span style="color: black; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span>:adv<span style="color: #009900;">)</span><span style="color: #009900;">{</span><br />        prex<span style="color: #009900;">[</span>k<span style="color: #009900;">]</span> &lt;- GM<span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>k<span style="color: #009900;">)</span>$predict    <br />    <span style="color: #009900;">}</span><br />&nbsp;<br />    value = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span>x<span style="color: #339933;">,</span>prex<span style="color: #009900;">)</span><br />&nbsp;<br />    res &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">(</span>index = <span style="color: #cc66cc;">1</span>:<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>value<span style="color: #009900;">)</span><span style="color: #339933;">,</span><br />                      value = value<span style="color: #339933;">,</span><br />                      type = <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>prex<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    <a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span><br />    p &lt;- <a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span>res<span style="color: #339933;">,</span>aes<span style="color: #009900;">(</span>x=index<span style="color: #339933;">,</span>y= value<span style="color: #009900;">)</span><span style="color: #009900;">)</span><br />    p + geom_point<span style="color: #009900;">(</span>aes<span style="color: #009900;">(</span>color=type<span style="color: #009900;">)</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span>+ <br />        geom_path<span style="color: #009900;">(</span>linetype=<span style="color: #cc66cc;">2</span><span style="color: #009900;">)</span> +<br />        theme_bw<span style="color: #009900;">(</span><span style="color: #009900;">)</span><br /><span style="color: #009900;">}</span><br />&nbsp;<br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 原始数据</span><br />x = <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">26.7</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">31.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">32.8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">34.1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">35.8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">37.5</span><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># 预测第7项</span><br />res &lt;- GM<span style="color: #009900;">(</span>x<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/print"><span style="color: #003399; font-weight: bold;">print</span></a><span style="color: #009900;">(</span>res<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">(</span>res<span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span></pre></div></div><br />
